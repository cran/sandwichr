<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2022-11-17" />

<title>A Tutorial for the sandwichr R Package</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">A Tutorial for the <code>sandwichr</code> R
Package</h1>
<h4 class="date">2022-11-17</h4>


<div id="TOC">
<ul>
<li><a href="#human-population-in-heshun-county-china">Human population
in Heshun County, China</a>
<ul>
<li><a href="#loading-data">Loading data</a></li>
<li><a href="#calculating-morans-i">Calculating Moran’s
<em>I</em></a></li>
<li><a href="#selection-of-the-ssh-layers">Selection of the SSH
layer(s)</a></li>
<li><a href="#running-the-sandwich-model">Running the Sandwich
model</a></li>
<li><a href="#model-validation">Model validation</a></li>
</ul></li>
<li><a href="#breast-cancer-incidence-in-mainland-china">Breast cancer
incidence in mainland China</a>
<ul>
<li><a href="#loading-data-1">Loading data</a></li>
<li><a href="#calculating-morans-i-1">Calculating Moran’s
<em>I</em></a></li>
<li><a href="#selection-of-the-ssh-layers-1">Selection of the SSH
layer(s)</a></li>
<li><a href="#running-the-sandwich-model-1">Running the Sandwich
model</a></li>
<li><a href="#model-validation-1">Model validation</a></li>
</ul></li>
</ul>
</div>

<p>The <code>sandwichr</code> package performs spatial interpolation<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> based on
the spatial stratified heterogeneity (SSH) theory<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. This model requires
three inputs: sampling, SSH, and reporting layers. The goal of this
model is to estimate the mean value of the sampling attribute and its
standard error for each reporting unit leveraging the known distribution
of the population in the SSH layer. Since this model does not rely on
the spatial dependence of the population, when the spatial dependence is
weak, Sandwich is still applicable as long as one properly stratifies
the geospatial surface.</p>
<p>To use the <code>sandwichr</code> package, first install it from
source code (only do this once).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install the sandwichr package</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;sandwichr&quot;)</span></span></code></pre></div>
<p>Then load the installed package into your environment using
<code>library()</code>. Remember to load the package every time you use
it.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the sandwichr package and other packages</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;sandwichr&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ape)</span></code></pre></div>
<p>Here,we present two case studies to demonstrate the functionality of
this package.</p>
<div id="human-population-in-heshun-county-china" class="section level2">
<h2>Human population in Heshun County, China</h2>
<p>The first case study interpolates the human population density in
Heshun County, China based on a sample of 167 units. A zonation consists
of 5 spatially contiguous strata is used as a candidate SSH layer. The
administrative division of 10 townships in Heshun County is used as the
reporting layer. The sampling, SSH, and reporting layers are all in the
shapefile format.</p>
<div id="loading-data" class="section level3">
<h3>Loading data</h3>
<p>To successfully run the model, the <code>load.data.shp</code>
function is used to prepare the shapefiles of sampling, SSH, and
reporting layers into a list of <code>sf</code> (simple feature; see <a href="https://r-spatial.github.io/sf/index.html">Simple Features for
R</a> for references) objects for model input. You can specify the
directory and names of your input files. Note that these input files
should locate in the same di</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Input data from shapefiles</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>hs.sampling.name <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;hs.sampling.shapefile.shp&quot;</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">package=</span><span class="st">&quot;sandwichr&quot;</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>hs.ssh.name <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;hs.ssh.shapefile.shp&quot;</span>, </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">package=</span><span class="st">&quot;sandwichr&quot;</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>hs.reporting.name <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;hs.reporting.shapefile.shp&quot;</span>, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">package=</span><span class="st">&quot;sandwichr&quot;</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>hs.data <span class="ot">&lt;-</span> <span class="fu">load.data.shp</span>(<span class="at">sampling.file=</span>hs.sampling.name, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                      <span class="at">ssh.file=</span>hs.ssh.name,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                      <span class="at">reporting.file=</span>hs.reporting.name)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hs.data[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 4 fields
## Geometry type: POINT
## Dimension:     XYZ
## Bounding box:  xmin: 156491.4 ymin: 4126601 xmax: 171510.5 ymax: 4153214
## z_range:       zmin: 1320.701 zmax: 1500
## Projected CRS: WGS 84 / UTM zone 50N
## # A tibble: 6 x 5
##   CODE  Population     x     y                      geometry
##   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;                   &lt;POINT [m]&gt;
## 1 02033         31  113.  37.5     Z (156491.4 4153214 1500)
## 2 01007         23  113.  37.2 Z (165240.2 4126601 1320.701)
## 3 01008         38  113.  37.2   Z (166538 4127516 1354.123)
## 4 01009         89  113.  37.3 Z (169540.8 4129381 1370.255)
## 5 01010         22  113.  37.3     Z (170685.2 4130558 1400)
## 6 01011        129  113.  37.3     Z (171510.5 4131899 1400)</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(hs.data[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## [1] &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(hs.data[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## $names
## [1] &quot;CODE&quot;       &quot;Population&quot; &quot;x&quot;          &quot;y&quot;          &quot;geometry&quot;  
## 
## $row.names
##   [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
##  [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
##  [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
##  [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
##  [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
##  [91]  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108
## [109] 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126
## [127] 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144
## [145] 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162
## [163] 163 164 165 166 167
## 
## $class
## [1] &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;
## 
## $sf_column
## [1] &quot;geometry&quot;
## 
## $agr
##       CODE Population          x          y 
##       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; 
## Levels: constant aggregate identity</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SSH</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hs.data[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## Simple feature collection with 5 features and 3 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 151114.4 ymin: 4106864 xmax: 228423.6 ymax: 4165211
## Projected CRS: WGS 84 / UTM zone 50N
## # A tibble: 5 x 4
##     STR  Area STR_1                                                     geometry
##   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;                                                &lt;POLYGON [m]&gt;
## 1     1  681. 01    ((174393.7 4131444, 174755.7 4136086, 166016.2 4129531, 161~
## 2     2  445. 02    ((211986.7 4145078, 191141.7 4123426, 191052.7 4123478, 190~
## 3     3  288. 03    ((198113.2 4115589, 201902.7 4118894, 204447.9 4121855, 211~
## 4     4  346. 04    ((222674.5 4139326, 219575.5 4133270, 215318.4 4129568, 211~
## 5     5  427. 05    ((172634.5 4164622, 171285.3 4160901, 169971.9 4159759, 173~</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(hs.data[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## [1] &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(hs.data[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## $names
## [1] &quot;STR&quot;      &quot;Area&quot;     &quot;STR_1&quot;    &quot;geometry&quot;
## 
## $row.names
## [1] 1 2 3 4 5
## 
## $class
## [1] &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;
## 
## $sf_column
## [1] &quot;geometry&quot;
## 
## $agr
##   STR  Area STR_1 
##  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt; 
## Levels: constant aggregate identity</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reporting</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hs.data[[<span class="dv">3</span>]])</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 2 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 151114.4 ymin: 4123480 xmax: 214095.3 ymax: 4165211
## Projected CRS: WGS 84 / UTM zone 50N
## # A tibble: 6 x 3
##   CODE   Area                                                           geometry
##   &lt;chr&gt; &lt;dbl&gt;                                                      &lt;POLYGON [m]&gt;
## 1 02    427.  ((153690.1 4149820, 153647.4 4149999, 153508.5 4150431, 153309.4 ~
## 2 06    143.  ((191225.5 4151326, 191387.6 4151395, 191542.2 4151533, 191625.6 ~
## 3 03    373.  ((178892 4151731, 179098.2 4151712, 179205.5 4151708, 179415.6 41~
## 4 05    252.  ((172768 4143250, 172542.9 4143207, 172248.9 4143115, 171995.3 41~
## 5 10     73.7 ((207615.6 4147664, 207785.4 4147473, 207928.5 4147388, 208079.1 ~
## 6 01    186.  ((172768 4143250, 173154.8 4143172, 173615.2 4143071, 173995.6 41~</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(hs.data[[<span class="dv">3</span>]])</span></code></pre></div>
<pre><code>## [1] &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(hs.data[[<span class="dv">3</span>]])</span></code></pre></div>
<pre><code>## $names
## [1] &quot;CODE&quot;     &quot;Area&quot;     &quot;geometry&quot;
## 
## $row.names
##  [1]  1  2  3  4  5  6  7  8  9 10
## 
## $class
## [1] &quot;sf&quot;         &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;
## 
## $sf_column
## [1] &quot;geometry&quot;
## 
## $agr
## CODE Area 
## &lt;NA&gt; &lt;NA&gt; 
## Levels: constant aggregate identity</code></pre>
</div>
<div id="calculating-morans-i" class="section level3">
<h3>Calculating Moran’s <em>I</em></h3>
<p>We use the Moran’s <em>I</em> to evaluate the SAC of the population
density in Heshun.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>hs.dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(<span class="fu">cbind</span>(hs.data[[<span class="dv">1</span>]]<span class="sc">$</span>x, hs.data[[<span class="dv">1</span>]]<span class="sc">$</span>y)))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>hs.dists.inv <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>hs.dists</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(hs.dists.inv) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Moran.I</span>(hs.data[[<span class="dv">1</span>]]<span class="sc">$</span>Population, hs.dists.inv)</span></code></pre></div>
<pre><code>## $observed
## [1] 0.1343253
## 
## $expected
## [1] -0.006024096
## 
## $sd
## [1] 0.01073216
## 
## $p.value
## [1] 0</code></pre>
</div>
<div id="selection-of-the-ssh-layers" class="section level3">
<h3>Selection of the SSH layer(s)</h3>
<p>The accuracy of SSH-based spatial interpolation is determined by the
SSH layer. For an ideal SSH layer, values of the target attribute are
expected to be homogeneous within each stratum and differ between the
strata. To determine a proper SSH layer for the Sandwich model, the
geographical detector model<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> is applied to quantify the SSH of the
target attribute with regard to the candidate stratification(s).</p>
<p>For the purpose of demonstration, we input
<code>hs.ssh2.shapefile</code> as another candidate SSH layer.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tools)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Input another candidate SSH layer for demonstration</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>hs.ssh2.name <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;hs.ssh2.shapefile.shp&quot;</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">package=</span><span class="st">&quot;sandwichr&quot;</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>hs.ssh2 <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="at">dsn=</span><span class="fu">dirname</span>(hs.ssh2.name),</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">layer=</span><span class="fu">file_path_sans_ext</span>(<span class="fu">basename</span>(hs.ssh2.name)))</span></code></pre></div>
<p>First, we combine the sampling and the candidate SSH layers to a
single data frame.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the SSH layer(s) for evaluation</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>hs.join <span class="ot">&lt;-</span> <span class="fu">ssh.data.shp</span>(<span class="at">object=</span>hs.data[[<span class="dv">1</span>]], <span class="at">ssh.lyr=</span>hs.data[[<span class="dv">2</span>]], <span class="at">ssh.id=</span><span class="st">&quot;STR_1&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>hs.join <span class="ot">&lt;-</span> <span class="fu">ssh.data.shp</span>(<span class="at">object=</span>hs.join, <span class="at">ssh.lyr=</span>hs.ssh2, <span class="at">ssh.id=</span><span class="st">&quot;STR_2&quot;</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hs.join)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 6 fields
## Geometry type: POINT
## Dimension:     XYZ
## Bounding box:  xmin: 156491.4 ymin: 4126601 xmax: 171510.5 ymax: 4153214
## z_range:       zmin: 1320.701 zmax: 1500
## Projected CRS: WGS 84 / UTM zone 50N
## # A tibble: 6 x 7
##   CODE  Population     x     y                      geometry STR_1 STR_2
##   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;                   &lt;POINT [m]&gt; &lt;chr&gt; &lt;chr&gt;
## 1 02033         31  113.  37.5     Z (156491.4 4153214 1500) 05    11   
## 2 01007         23  113.  37.2 Z (165240.2 4126601 1320.701) 05    02   
## 3 01008         38  113.  37.2   Z (166538 4127516 1354.123) 05    02   
## 4 01009         89  113.  37.3 Z (169540.8 4129381 1370.255) 05    02   
## 5 01010         22  113.  37.3     Z (170685.2 4130558 1400) 05    02   
## 6 01011        129  113.  37.3     Z (171510.5 4131899 1400) 05    02</code></pre>
<p>The factor detector <em>q</em>-statistic in the geographical detector
model is applied through the <code>ssh.test</code> function to measure
the SSH of the sampling data in terms of different stratifications. This
function takes a data frame generated from the <code>ssh.data.shp</code>
(or <code>ssh.data.txt</code>, which will be introduced later) function
(argument <code>object</code>), where the field names of the sampling
attribute (argument <code>y</code>) and the strata ID(s) (argument
<code>x</code>) need to be specified. In this example, the output of
<code>ssh.test</code> implies that the original candidate SSH layer
(<em>q</em> = .91) has a higher determinant power over the attribute
(population density) compared to hs.ssh2 (<em>q</em> = .39). Therefore,
compared to <code>hs.ssh2</code>, it will be more reasonable to select
the original one as the SSH layer for subsequent interpolation.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the geographical detector q-statistic</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh.test</span>(<span class="at">object=</span>hs.join, <span class="at">y=</span><span class="st">&quot;Population&quot;</span>, <span class="at">x=</span><span class="fu">c</span>(<span class="st">&quot;STR_1&quot;</span>, <span class="st">&quot;STR_2&quot;</span>), <span class="at">test=</span><span class="st">&quot;factor&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
##       q-statistic      p-value
## STR_1   0.5841001 3.386389e-10
## 
## [[2]]
##       q-statistic      p-value
## STR_2   0.2540372 8.683782e-06</code></pre>
<p>The <code>ssh.test</code> function implements the interaction
detector in the geographical detector model by specifying
<code>test=&quot;interaction&quot;</code>. The result of our example shows that
the combined <em>q</em>-statistic of the original candidate SSH layer
and <code>hs.ssh2</code> (<em>q</em> = .92) is approximately the same as
that of using the original one alone (<em>q</em> = .91). Therefore, we
can either optimize the SSH layer by combining two SSH layers or simply
use the original one. For the purpose of simplicity, we will use the
original one alone as the SSH layer in the subsequent modeling.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the interaction detector</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh.test</span>(<span class="at">object=</span>hs.join, <span class="at">y=</span><span class="st">&quot;Population&quot;</span>, <span class="at">x=</span><span class="fu">c</span>(<span class="st">&quot;STR_1&quot;</span>, <span class="st">&quot;STR_2&quot;</span>), <span class="at">test=</span><span class="st">&quot;interaction&quot;</span>)</span></code></pre></div>
<pre><code>##      [,1]    [,2]    [,3]               
## [1,] &quot;STR_1&quot; &quot;STR_2&quot; &quot;0.620092311481712&quot;
## [2,] &quot;STR_1&quot; &quot;STR_1&quot; &quot;0.58410012034806&quot; 
## [3,] &quot;STR_2&quot; &quot;STR_2&quot; &quot;0.254037208669126&quot;</code></pre>
</div>
<div id="running-the-sandwich-model" class="section level3">
<h3>Running the Sandwich model</h3>
<p>The SSH-based spatial interpolation is performed using the
<code>sandwich.model</code> function, which outputs the mean value of
the sampling attribute and its standard error for each reporting
unit.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the SSH based spatial interpolation</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>hs.sw <span class="ot">&lt;-</span> <span class="fu">sandwich.model</span>(<span class="at">object=</span>hs.data, <span class="at">sampling.attr=</span><span class="st">&quot;Population&quot;</span>, <span class="at">type=</span><span class="st">&quot;shp&quot;</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hs.sw<span class="sc">$</span>object)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 5 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 151114.4 ymin: 4123480 xmax: 214095.3 ymax: 4165211
## Projected CRS: WGS 84 / UTM zone 50N
## # A tibble: 6 x 6
##   CODE   Area                                         geometry  mean    se    df
##   &lt;chr&gt; &lt;dbl&gt;                                    &lt;POLYGON [m]&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 02    427.  ((153690.1 4149820, 153647.4 4149999, 153508.5 ~  211.  5.28    91
## 2 06    143.  ((191225.5 4151326, 191387.6 4151395, 191542.2 ~  287.  1.28    18
## 3 03    373.  ((178892 4151731, 179098.2 4151712, 179205.5 41~  304.  1.21    90
## 4 05    252.  ((172768 4143250, 172542.9 4143207, 172248.9 41~  178.  6.80    91
## 5 10     73.7 ((207615.6 4147664, 207785.4 4147473, 207928.5 ~  225.  1.94    40
## 6 01    186.  ((172768 4143250, 173154.8 4143172, 173615.2 41~  207.  5.46    91</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hs.sw)</span></code></pre></div>
<pre><code>## [1] &quot;Sample size:  167&quot;
## [1] &quot;Number of SSH strata:  5&quot;
## [1] &quot;Number of reporting units:  10&quot;</code></pre>
<pre><code>##       mean             se                 geometry 
##  Min.   :133.7   Min.   :1.214   POLYGON      :10  
##  1st Qu.:179.7   1st Qu.:1.446   epsg:32650   : 0  
##  Median :209.3   Median :2.105   +proj=utm ...: 0  
##  Mean   :220.7   Mean   :3.035                     
##  3rd Qu.:271.4   3rd Qu.:4.697                     
##  Max.   :303.7   Max.   :6.800</code></pre>
<p>The interpolated values and the standard errors can be visualized
using <code>plot.mean</code> and <code>plot.se()</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the estimated mean values and standard errors</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">object=</span>hs.sw)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt=" " />
<p class="caption">
</p>
</div>
<p>We examine the normality of the random sample.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(hs.data[[<span class="dv">1</span>]]<span class="sc">$</span>Population, <span class="at">pch=</span><span class="dv">1</span>, <span class="at">frame=</span><span class="cn">FALSE</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(hs.data[[<span class="dv">1</span>]]<span class="sc">$</span>Population, <span class="at">col=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAyVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtGgrRmAABmADpmOgBmOjpmZgBmZjpmkGZmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQkGaQkLaQtpCQttuQ27aQ2/+2ZgC2Zjq2ZpC2kGa225C227a22/+2/7a2///bkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb/9vb////tmb/25D/27b//7b//9v////2SFSlAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM1ElEQVR4nO2dC4PjNhHHleUCGygtzabHq/R2gcL6oBxnej0o673E3/9DoffDljR2LMnyMv92E5/j6PGLNBpbY5n0qKjI2gWoXQgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgABlBNQQck/fzidyO/u7lweyf9L/+PBrQsgv3zw5R4x2tkTo83eD78sv/O397GL0uQGxQi4GdH4ta/7qnTnAs1MBIrtHD6BPr28qBMSa0FJAdFPJVNG3UwOiXx0DakiVgGihFCDWJX7yNSt1S3bfviY3/6AffPiM7N70/zqQV4/8GNYuPn90ANF671hH+nAg5KjS9u1sBYJPJ9qE1Pd1po0LeLoyA6Kll4Ba9eOqzf2PJ/mDf6YK33m6CN3acXgsIatVjXdKQIy/AmQyrRPQzW9omQSg5wMrZst/b/q6f9f/m35A//U9Lfgb8QGt1c+e2JFHC5DVQxtFxb9TAvp4ou/i+3amVXaxm+9oZUVlZPn4W6uHN1p88cqpMH38O21PtxYg/YloGn1459gG2ZnWCeg9/X3/erIqzKsj6yTI6QZGa3z5o6hgBBBrdmT/QxSQ6qJOppUCotX7KSOg+kTHGk8IEBuaXv3548kBpEzYl6y+vMMK82XvFPlJQLtfKT/IybRSQKLUE1uQaCxnF5Cwx3Tn7rdEVJq+/dfdKfJrXTdgGy2o5xUa2SA/IP5LD420GNGpnyfGxD68cwRoCzZINPzRKBZsQfunTw+uDRKIjY8Q3jkG5Ml0trIDYlUZ+UFhGzQy0r1sJ9y8fK0JeXaOAdmZdlX6QaxAHbE86T+wrego9uovrfZjpOR56e9sV9qz0wPIyvTy1j2Zm6otXe64vP3iadrOhNoSoFWEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAiQAXQ+HXnsV9ZpuO3JAGr2T8+H276ZH5L6oqUBnU/3fUfo33VRIi9WDqCGBe8gIEdWF7s9n1gEF3YxR7aR5vHFyMfVCx3m7+5SpfQyAUX4EDKvytbRPKS7OYaP3YzuwoBIP7NRmIO73WPLjPT2CQF85hHSx14eqCPNYkI3P8xH+CwBxPwgBmj7jmLMQCdoQc3WT8Z8fIxlXmyDWn4jzoZldzARJe1SWTaKkSvD0euR5KPRyL/+aofmpflBd3eSjfjjFURARoyPYNM7//cIiIt2MMZmyGi2ZbYkvmfdPHPlXUNViBkg1bl4B1Mmeq5ltvSCWhC5UwZI2x9pqhelmqZwFYgQyUc0ouVoZLIpEqlBjI9qM4nYiHT5Kz1F1WZokzaIECIMdEo2IuW0ya0kySc9Hvtk9SvhQ2/xZDUjnzGgDV7uIMQY6PSJi7fG+EGbu2Bm+GRJXW2oFnRdKulHj1mZiw6WJ/Wqk5uUZVY+Vo3UXeuLbFBxQER1sGwZ6K0mhXUuDIhoPvkBpZnOKAqIKD4ZG5B70T5hcgVUhI990T7FrHxBQGX42BftU1yuXwNQXt/C6mIpTlbLASrEZ7t+kO5gufOpOrlYTmX4uAFUYBcDncligMR1w/x83CjX9rZ/PkRMdavOZLvQKW0pQOKKcwE+rqPYseiO8Nw8m76XCh1VDlCZDjZwFJ9/8Z7/BWT5kqHLagUBRcNcEuakNljzYJc8IoDqaUHKQyyRld5ilxKbY6yL9Tr0Y20bVMQDklmZzYavKBr1E9VIF4RYBlD2U3g7r6qTC+WS/xTM5FV1coFMCvKZeS5WhaNYsoONaxSdFqvCURQjfLH5gVE2kfvF6hjmi3YwT40iTSjsKBac9sk8iTHOb7gjMrNaQwsqzWdUo+j9YhU4imUNUO8ZxaJx5Os7ijlnmf0ZVp2cJwMeh1jy0nfVyY3TL2uAeudsnrVcdlMmNIHYReLxMxe9eAczNZI+YEuinnRDyPH5i6fwLGPmGQYVh5g1l0Ge4q0zjzeJjGLsTqCGH7nOMK/jELPmMsiTv+ppVethS2PxdvP8cwZonSuK2eLsIlJRrrLLtPvvY54064aX//TrtKB8cYjRXPnrhKvNTNrLDoaC5IwiUHGIawCyIheii5u0wlSFp/EzhqEQFQe9BiBjpIWJWZpceplA39IxWvJdD/PLQjzyAcoUSA9nrDaEo7j0jt5cxdcdLFP6kZyrTk4nS/gZ2BpRxlsApK8BrcBnC4BW5bMBQIYPAvInmfFOlSnZV50cT3K1AUxkbzZTrB+UA9CKBqh3woAXrB+UcdpnZT5ufNDy9YOS16PkLLO/AGojzfpBqWuyooeoSqA20qwflBzQCtcQByXQW0nWD0o9KN7JBlQDoCTrByWuyJ1ezWU1Ve0HrXMNcVCGipOrgU/VgNY8BdNSF+2Nq1fNML/SNdaB5uVeMkaxig42s0YlYxQ1n3oA8X4WcxNLRpitNYkxLojeEjM/bcQRKnYzC8m2GtAVZVEblwdR+8ipRqkWRFabBPMVRm1MWT+oTIwiISvNMvtLozZUC4rd7VMmRrEqPqP75tc/WV35Iv1QoyjXZb7i8jqtO8kzVnWOIlkhDjGm2hxFsvo11oFMSeD75gsM86T0nQagrFEMvNaa/2aW+vjMWj9oQgtaWJjKDDSTc9EeEuwoLioKqc1AM5myTAm+m3THy7UlqZKPDeiQ4ILZ9eWQfOoyQL3TxdZ8cFa1fGYZ6Yyl4B2rMg9IaJaRzlYIog3QamUIaY6RzvVoANF8Sq1WMlPjk9VI1S8POSy49DDr5DP7ZDW9JRfNp8xqSVdo5o+WZLFFO3vRvQott3WN5pysJs7ZOoGrl8+8Rd6SZOhVrR3MMdLgIm+L81LNZUN8Zi3yNjlN486ITaIf2UT05gDQ0jyzyXEUgUXeZiRJ7E31SvpeUVLWuXo+lg2asMjbjBSJuymf1TQAVH8Hc4b5CYu8TU8xAEiDMRuF1kO8Vhkiv82rA0j9ZwZ3obr5ZLl3oPfaIOUVDlU3Hw3o+XCMr8oxJ83QKOZT5XwUIO4fsvOI7I7iQJV3MA2I3y3Pn6wRvW9+WVZ+D9HvWqdRilLzV36PjzhVz/f4rFhxo1XJ8sWpUoDuJSUE5E1DrOvCzU++c7EtA+KWh4cnZpzc2DSgbvd4PrG2k+QRSNGsZn9WBSDmAlE+z4eMT5vfNqACQkALskJAQFYIaLNCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQEqB4jfjBcONQ5FlcQnM8OxKEB2k1UM0OWB1jO8Yv755L/Wy+7m74KEQt8Cs5uuYoDknEmgQrSdeD8R4e2hyczQt8DsZqiwDQo0ho4c/fNx0XoGvwVlN0eFAYUnTQKAos9gAKc5E8zRlAUUuRHPX1XRBMINIQ4oxX1/RQF1EaOZAVAsu8kqCSj6g6bvYmnuGy0BqBUeSesrcKu8lSuMdPBbMuUk93eVa0HAqiD+qsaH+Rigpc93UCroB8V/0EBV445iGBCU3WQVA9SKmK/Z5raNnmoEAUHZTRaerAJCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQECAEBAgBAUJAgBAQIAQECAEBQkCAEBAgBAQIAQFCQIAQEKB8gMzisP+cuhJzd+9ftdns7OD5dplIquWf87YgEf80tazB49QHYrHdeOCGOvb/EpAMpIouArVNQL8/EPloJRVPJjbOX/2JRTqL3WxR/f2PJ3UcX/KJ8O/JyuonmfP1+tR+fcw3tE/f60T4Zyo/vl7/dcDKAGJR7/JPLpbGasCqydYKUbu16WA7GA21Jo0EpJcE727ea0DmGJGBSoQ/3FsmrBcgu0JlAB15v9ArOInAOr7izNFa2MnUTbQU/kw4VjkJSEeadYID228dozLRgHTCSxaNKmaD6IuoIK2EMCKyNr3erepm25iOkCgg9xhORQOyEl7zgWAxDQDJcV8CkrXp9W4NSHUlakJuvjMtyNvFnGMGgFTC4tafmm2Q3YJ6NQy5LUgeZ7cg/m51MWOk908qTfcYXwtSaq6LVywJSI+8lg0yHcUAUiC46ehMF+PD/OVh/wM36MLkuMe4gNyR/spxvyQgsUoa+yXNKMYHdbmbVVqPYpeHW9EwyNHUreGE2FpZ7GlfdOvePUZaZnsUYwnzpnTlnT9FAXG/hNtL5QeJmqvdzcAP4iHAjWxoXNKs0IPZmcw3wgaZY/i4P/CDRBO7OiJ4myerbxOsODtR2wRUUAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAoSAACEgQAgIEAIChIAAISBACAgQAgKEgAAhIEAICBACAvQ/BbsXp9rs4/wAAAAASUVORK5CYII=" /></p>
<p>The confidence interval for the population mean in each reporting
unit is computed using the <code>sandwich.ci</code> function. Here, we
show an example of constructing a 95% confidence interval.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confidence intervals of the interpolation estimates</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>hs.sw.ci <span class="ot">&lt;-</span> <span class="fu">sandwich.ci</span>(<span class="at">object=</span>hs.sw, <span class="at">level=</span>.<span class="dv">95</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hs.sw.ci<span class="sc">$</span>object<span class="sc">$</span>object)</span></code></pre></div>
<pre><code>## Simple feature collection with 6 features and 7 fields
## Geometry type: POLYGON
## Dimension:     XY
## Bounding box:  xmin: 151114.4 ymin: 4123480 xmax: 214095.3 ymax: 4165211
## Projected CRS: WGS 84 / UTM zone 50N
## # A tibble: 6 x 8
##   CODE   Area                            geometry  mean    se    df ci.low ci.up
##   &lt;chr&gt; &lt;dbl&gt;                       &lt;POLYGON [m]&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 02    427.  ((153690.1 4149820, 153647.4 41499~  211.  5.28    91   201.  222.
## 2 06    143.  ((191225.5 4151326, 191387.6 41513~  287.  1.28    18   284.  289.
## 3 03    373.  ((178892 4151731, 179098.2 4151712~  304.  1.21    90   301.  306.
## 4 05    252.  ((172768 4143250, 172542.9 4143207~  178.  6.80    91   165.  192.
## 5 10     73.7 ((207615.6 4147664, 207785.4 41474~  225.  1.94    40   221.  229.
## 6 01    186.  ((172768 4143250, 173154.8 4143172~  207.  5.46    91   196.  218.</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(hs.sw.ci)</span></code></pre></div>
<pre><code>##      ci.low          ci.up                geometry 
##  Min.   :127.8   Min.   :139.7   POLYGON      :10  
##  1st Qu.:174.0   1st Qu.:188.9   epsg:32650   : 0  
##  Median :198.6   Median :220.0   +proj=utm ...: 0  
##  Mean   :214.6   Mean   :226.7                     
##  3rd Qu.:268.4   3rd Qu.:274.4                     
##  Max.   :301.3   Max.   :306.1</code></pre>
<p>The lower and upper bounds of the confidence interval can be
visualized using the <code>plot.ci</code> function.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the confidence intervals of the interpolation estimates</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">object=</span>hs.sw.ci)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt=" " />
<p class="caption">
</p>
</div>
</div>
<div id="model-validation" class="section level3">
<h3>Model validation</h3>
<p>To evaluate the overall accuracy of the SSH-based spatial
interpolation, a <em>k</em>-fold cross validation can be performed using
the <code>sandwich.cv</code> function. A diagnostic statistic called
root mean square error (RMSE) will be calculated. Here, we present the
result of a 5-fold cross validation.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-fold cross validation</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>hs.cv <span class="ot">&lt;-</span> <span class="fu">sandwich.cv</span>(<span class="at">object=</span>hs.data, <span class="at">sampling.attr=</span><span class="st">&quot;Population&quot;</span>, <span class="at">k=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">&quot;shp&quot;</span>, <span class="at">ssh.id.col=</span><span class="st">&quot;STR_1&quot;</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>hs.cv</span></code></pre></div>
<pre><code>## [1] 116.2438</code></pre>
</div>
</div>
<div id="breast-cancer-incidence-in-mainland-china" class="section level2">
<h2>Breast cancer incidence in mainland China</h2>
<p>The second case study interpolates the breast cancer incidence across
mainland China based on 242 samples retrieved from the Chinese Cancer
Registry Annual Report. The urban-rural classification (either urban or
rural areas are typically not connected in space) is used as the SSH
layer. County-level divisions are used as the reporting units. In this
example, all the input data are in csv format.</p>
<div id="loading-data-1" class="section level3">
<h3>Loading data</h3>
<p>The <code>load.data.txt</code> function is used to prepare text files
into a list of data frames for model input. Two files are needed for
this function: one linking sampling and SSH layers, and the other
linking reporting and SSH layers.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Input data from text files</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>bc.sampling_ssh.name <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;bc_sampling_ssh.csv&quot;</span>, </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">package=</span><span class="st">&quot;sandwichr&quot;</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>bc.reporting_ssh.name <span class="ot">&lt;-</span> <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;bc_reporting_ssh.csv&quot;</span>, </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">package=</span><span class="st">&quot;sandwichr&quot;</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>bc.data <span class="ot">&lt;-</span> <span class="fu">load.data.txt</span>(<span class="at">sampling_ssh.file=</span>bc.sampling_ssh.name, </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>                         <span class="at">reporting_ssh.file=</span>bc.reporting_ssh.name)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sampling-SSH</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bc.data[[<span class="dv">1</span>]])    </span></code></pre></div>
<pre><code>##   GBCODE Incidence SSHID        X        Y
## 1 110100        42     1 115.9642 39.86494
## 2 120100        44     1 117.3913 39.01184
## 3 120225        26     2 117.4309 40.00251
## 4 130129         9     2 114.2797 37.61767
## 5 130181        36     1 115.2870 37.91756
## 6 130227        20     2 118.3576 40.23177</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(bc.data[[<span class="dv">1</span>]])</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reporting-SSH</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bc.data[[<span class="dv">2</span>]])    </span></code></pre></div>
<pre><code>##   GBCODE        W1        W2
## 1 110100 0.8736000 0.1264000
## 2 110112 0.6115000 0.3885000
## 3 110113 0.5378000 0.4622000
## 4 110221 0.5245597 0.4754403
## 5 110224 0.5245597 0.4754403
## 6 110226 0.5245597 0.4754403</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(bc.data[[<span class="dv">2</span>]])</span></code></pre></div>
<pre><code>## [1] &quot;data.frame&quot;</code></pre>
</div>
<div id="calculating-morans-i-1" class="section level3">
<h3>Calculating Moran’s <em>I</em></h3>
<p>We use the Moran’s <em>I</em> to evaluate the SAC of the breast
cancer incidence.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>bc.dists <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(<span class="fu">dist</span>(<span class="fu">cbind</span>(bc.data[[<span class="dv">1</span>]]<span class="sc">$</span>X, bc.data[[<span class="dv">1</span>]]<span class="sc">$</span>Y)))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>bc.dists.inv <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>bc.dists</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(bc.dists.inv) <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Moran.I</span>(bc.data[[<span class="dv">1</span>]]<span class="sc">$</span>Incidence, bc.dists.inv)</span></code></pre></div>
<pre><code>## $observed
## [1] 0.04940197
## 
## $expected
## [1] -0.004149378
## 
## $sd
## [1] 0.008379477
## 
## $p.value
## [1] 1.650469e-10</code></pre>
</div>
<div id="selection-of-the-ssh-layers-1" class="section level3">
<h3>Selection of the SSH layer(s)</h3>
<p>First, we use the <code>ssh.data.txt</code> function to convert the
input data for evaluation.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the SSH layer for evaluation</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>bc.join <span class="ot">&lt;-</span> <span class="fu">ssh.data.txt</span>(<span class="at">object=</span>bc.data)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bc.join)</span></code></pre></div>
<pre><code>##   GBCODE Incidence SSHID        X        Y
## 1 110100        42     1 115.9642 39.86494
## 2 120100        44     1 117.3913 39.01184
## 3 120225        26     2 117.4309 40.00251
## 4 130129         9     2 114.2797 37.61767
## 5 130181        36     1 115.2870 37.91756
## 6 130227        20     2 118.3576 40.23177</code></pre>
<p>The factor detector <em>q</em>-statistic in the geographical detector
model is applied through the <code>ssh.test</code> function to measure
the SSH of the sample regarding the urban-rural classification. In this
example, the output of <code>ssh.test</code> implies a relatively high
level of SSH in the distribution of breast cancer incidence concerning
the given stratification (<em>q</em> = .52). Therefore, it is reasonable
to select the urban-rural classification as the SSH layer for subsequent
interpolation.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the geographical detector q-statistic</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ssh.test</span>(<span class="at">object=</span>bc.join, <span class="at">y=</span><span class="st">&quot;Incidence&quot;</span>, <span class="at">x=</span><span class="st">&quot;SSHID&quot;</span>, <span class="at">test=</span><span class="st">&quot;factor&quot;</span>, <span class="at">type=</span><span class="st">&quot;txt&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
##       q-statistic      p-value
## SSHID   0.5165114 7.219864e-11</code></pre>
<p>We can visualize the mean and standard deviation of the sampled
breast cancer incidence in each stratum.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="fu">ggerrorplot</span>(bc.data[[<span class="dv">1</span>]], <span class="at">x =</span> <span class="st">&quot;SSHID&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Incidence&quot;</span>, </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">desc_stat =</span> <span class="st">&quot;mean_sd&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">add =</span> <span class="st">&quot;violin&quot;</span>, <span class="at">add.params =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">&quot;darkgray&quot;</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Urban&quot;</span>, <span class="st">&quot;2&quot;</span> <span class="ot">=</span> <span class="st">&quot;Rural&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">y=</span><span class="st">&quot;Breast Cancer Incidence (Rate per 100,000)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>bc.data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span>                                        </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SSHID) <span class="sc">%&gt;%</span>                         </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(Incidence),              </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>               <span class="fu">list</span>(<span class="at">name =</span> mean))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   SSHID  name
##   &lt;int&gt; &lt;dbl&gt;
## 1     1  31.6
## 2     2  17.5</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>bc.data[[<span class="dv">1</span>]] <span class="sc">%&gt;%</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SSHID) <span class="sc">%&gt;%</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(Incidence), <span class="at">sd=</span><span class="fu">sd</span>(Incidence), <span class="at">n=</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   SSHID  mean    sd     n
##   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
## 1     1  31.6  8.07   125
## 2     2  17.5  5.12   117</code></pre>
</div>
<div id="running-the-sandwich-model-1" class="section level3">
<h3>Running the Sandwich model</h3>
<p>The SSH-based spatial interpolation is performed using the
<code>sandwich.model</code> function, which outputs the mean value of
the sampling attribute and its standard error for each reporting
unit.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform the SSH based spatial interpolation</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>bc.sw <span class="ot">&lt;-</span> <span class="fu">sandwich.model</span>(<span class="at">object=</span>bc.data, <span class="at">sampling.attr=</span><span class="st">&quot;Incidence&quot;</span>, <span class="at">type=</span><span class="st">&quot;txt&quot;</span>, </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">ssh.id.col=</span><span class="st">&quot;SSHID&quot;</span>, <span class="at">ssh.weights=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">c</span>(<span class="st">&quot;W1&quot;</span>,<span class="st">&quot;W2&quot;</span>)))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bc.sw<span class="sc">$</span>object)</span></code></pre></div>
<pre><code>##   GBCODE        W1        W2     mean        se  df
## 1 110100 0.8736000 0.1264000 29.78768 0.7965111 240
## 2 110112 0.6115000 0.3885000 26.11263 0.6894776 240
## 3 110113 0.5378000 0.4622000 25.07924 0.6604525 240
## 4 110221 0.5245597 0.4754403 24.89360 0.6552986 240
## 5 110224 0.5245597 0.4754403 24.89360 0.6552986 240
## 6 110226 0.5245597 0.4754403 24.89360 0.6552986 240</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bc.sw)</span></code></pre></div>
<pre><code>## [1] &quot;Sample size:  242&quot;
## [1] &quot;Number of SSH strata:  2&quot;
## [1] &quot;Number of reporting units:  2352&quot;</code></pre>
<pre><code>##       mean             se        
##  Min.   :17.54   Min.   :0.4732  
##  1st Qu.:21.22   1st Qu.:0.5579  
##  Median :22.38   Median :0.5876  
##  Mean   :22.73   Mean   :0.5986  
##  3rd Qu.:23.86   3rd Qu.:0.6270  
##  Max.   :31.56   Max.   :0.8498</code></pre>
<p>We examine the normality of the random sample.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(bc.data[[<span class="dv">1</span>]]<span class="sc">$</span>Incidence, <span class="at">pch=</span><span class="dv">1</span>, <span class="at">frame=</span><span class="cn">FALSE</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(bc.data[[<span class="dv">1</span>]]<span class="sc">$</span>Incidence, <span class="at">col=</span><span class="st">&quot;steelblue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /></p>
<p>For the purpose of demonstration, the confidence interval for the
population mean in each reporting unit is computed using the
<code>sandwich.ci</code> function. Here, we show an example of
constructing a 95% confidence interval.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the confidence intervals of the interpolation estimates</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>bc.sw.ci <span class="ot">&lt;-</span> <span class="fu">sandwich.ci</span>(<span class="at">object=</span>bc.sw, <span class="at">level=</span>.<span class="dv">95</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(bc.sw.ci<span class="sc">$</span>object<span class="sc">$</span>object)</span></code></pre></div>
<pre><code>##   GBCODE        W1        W2     mean        se  df   ci.low    ci.up
## 1 110100 0.8736000 0.1264000 29.78768 0.7965111 240 28.21863 31.35672
## 2 110112 0.6115000 0.3885000 26.11263 0.6894776 240 24.75443 27.47083
## 3 110113 0.5378000 0.4622000 25.07924 0.6604525 240 23.77822 26.38027
## 4 110221 0.5245597 0.4754403 24.89360 0.6552986 240 23.60272 26.18447
## 5 110224 0.5245597 0.4754403 24.89360 0.6552986 240 23.60272 26.18447
## 6 110226 0.5245597 0.4754403 24.89360 0.6552986 240 23.60272 26.18447</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bc.sw.ci)</span></code></pre></div>
<pre><code>##      ci.low          ci.up      
##  Min.   :16.60   Min.   :18.48  
##  1st Qu.:20.12   1st Qu.:22.32  
##  Median :21.22   Median :23.54  
##  Mean   :21.55   Mean   :23.91  
##  3rd Qu.:22.63   3rd Qu.:25.10  
##  Max.   :29.88   Max.   :33.24</code></pre>
</div>
<div id="model-validation-1" class="section level3">
<h3>Model validation</h3>
<p>To evaluate the overall accuracy of SSH-based spatial interpolation,
a <em>k</em>-fold cross validation can be performed using the
<code>sandwich.cv</code> function. A diagnostic statistic called root
mean square error (RMSE) will be calculated. Here, we present the result
of a 5-fold cross validation.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform k-fold cross validation</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>bc.cv <span class="ot">&lt;-</span> <span class="fu">sandwich.cv</span>(<span class="at">object=</span>bc.data, <span class="at">sampling.attr=</span><span class="st">&quot;Incidence&quot;</span>, <span class="at">k=</span><span class="dv">5</span>, <span class="at">type=</span><span class="st">&quot;txt&quot;</span>, </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ssh.id.col=</span><span class="st">&quot;SSHID&quot;</span>, <span class="at">reporting.id.col=</span><span class="st">&quot;GBCODE&quot;</span>, </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ssh.weights=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="fu">c</span>(<span class="st">&quot;W1&quot;</span>,<span class="st">&quot;W2&quot;</span>)))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>bc.cv</span></code></pre></div>
<pre><code>## [1] 8.680166</code></pre>
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Wang, J. F., Haining, R., Liu, T. J., Li, L. F., &amp;
Jiang, C. S. (2013). Sandwich estimation for multi-unit reporting on a
stratified heterogeneous surface. <em>Environment and Planning A</em>,
45(10), 2515-2534.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Wang, J. F., Haining, R., Liu, T. J., Li, L. F., &amp;
Jiang, C. S. (2013). Sandwich estimation for multi-unit reporting on a
stratified heterogeneous surface. <em>Environment and Planning A</em>,
45(10), 2515-2534.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>Wang, J. F., Li, X. H., Christakos, G., Liao, Y. L.,
Zhang, T., Gu, X., &amp; Zheng, X. Y. (2010). Geographical
detectors-based health risk assessment and its application in the neural
tube defects study of the Heshun Region, China. <em>International
Journal of Geographical Information Science</em>, 24(1), 107-127.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
